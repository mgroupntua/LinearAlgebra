using System.IO;
using MGroup.LinearAlgebra.Tests.Utilities;

namespace MGroup.LinearAlgebra.Tests.TestData
{
	/// <summary>
	/// A square asymmetric 10-by-10 matrix that is invertible, but LU factorization needs pivoting.
	/// Authors: Serafeim Bakalakos
	/// </summary>
	internal static class SquareInvertible10by10
	{
		internal const int Order = 10;

		internal static double[,] Matrix => new double[,] {
			{ 1.0000,    2.6667,    7.0000,    5.0000,    2.5000,    9.0000,    6.0000,    2.2500,    4.0000,    3.0000 },
			{ 0.0000,    0.3333,    1.0000,   -2.5000,    5.5000,   -7.7500,    2.0000,    5.7500,    3.0000,    2.0000 },
			{ 2.0000,    2.0000,    4.0000,    9.0000,    1.7500,    5.0000,    3.5000,    2.0000,    6.0000,    8.0000 },
			{ 1.0000,    1.0000,    3.0000,    5.0000,    1.7500,    6.0000,    4.0000,    7.0000,    6.0000,    9.0000 },
			{ 5.0000,    0.6667,    4.5000,    5.0000,    0.2500,    2.3333,    1.5000,    1.2500,    9.0000,    0.7500 },
			{ 0.3333,    2.0000,    4.0000,    5.0000,    5.0000,    9.0000,    2.5000,    4.0000,    1.0000,    3.0000 },
			{ 0.2500,    6.0000,    8.0000,    0.7500,    1.0000,    3.0000,    8.0000,    1.2500,    1.0000,    2.0000 },
			{ 1.0000,    1.0000,    1.0000,    7.0000,    1.0000,    5.0000,    2.0000,    7.0000,    1.0000,    2.0000 },
			{ 3.5000,    9.0000,    9.0000,    2.0000,    8.0000,    4.0000,    2.5000,    6.0000,    7.0000,    9.0000 },
			{ 3.0000,    7.0000,    9.0000,    4.0000,    2.6667,    9.0000,    8.0000,    5.0000,    7.0000,    3.0000 }};

		internal static double[] Lhs => new double[] {
			3.4484, 1.9563, 2.7385, 4.2828, 5.3064, 4.3251, 0.1117, 4.0487, 2.6311, 2.6269
		};

		internal static double[] Rhs => MatrixOperations.MatrixTimesVector(Matrix, Lhs);

		internal static double[] Diagonal => new double[]
		{
			1, 0.3333, 4, 5, 0.25, 9, 8, 7, 7, 3
		};

		internal static double[,] FactorL => new double[,] {
			{ 1.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
			{ 0.700000000000000, 1.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
			{ 0.200000000000000, 0.296878936778343,  1.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
			{ 0.200000000000000, 0.101561996458584, -0.113249698822564,  1.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
			{ 0.000000000000000, 0.039058700551134,  0.176818919005663, -0.484906542960240,  1.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
			{ 0.050000000000000, 0.699220466618463,  0.844451573716728, -0.331295118269131, -0.863097189214223,  1.000000000000000,  0.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
			{ 0.600000000000000, 0.773437271117538,  0.406895919175001,  0.052792355932608, -0.684415331679188,  0.241574580261808,  1.000000000000000,  0.000000000000000,  0.000000000000000, 0.000000000000000},
			{ 0.400000000000000, 0.203123992917168,  0.231873657358311,  0.942630231346478, -0.024512562835827,  0.346259134817979, -0.586219649578724,  1.000000000000000,  0.000000000000000, 0.000000000000000},
			{ 0.200000000000000, 0.101561996458584,  0.345123356180875,  0.393366691999442,  0.151258061047848, -0.165741667413086,  0.355479089484414, -0.373132913343019,  1.000000000000000, 0.000000000000000},
			{ 0.066660000000000, 0.229167553739405,  0.540742649585241,  0.391641616972103,  0.581445473311093, -0.628021544221750,  0.073364914263990,  0.198333706840520, -0.659496414881728, 1.000000000000000}
		};

		internal static double[,] FactorU => new double[,] {
			{ 5.000000000000000, 0.666700000000000, 4.500000000000000,  5.000000000000000, 0.250000000000000,  2.333300000000000, 1.500000000000000,  1.250000000000000,  9.000000000000000,  0.750000000000000 },
			{ 0.000000000000000, 8.533310000000000, 5.850000000000000, -1.500000000000000, 7.825000000000000,  2.366690000000000, 1.450000000000000,  5.125000000000000,  0.699999999999999,  8.475000000000000 },
			{ 0.000000000000000, 0.000000000000000, 4.363258219846695,  4.445318405167514, 0.126922319709468,  7.830719589116065, 5.269525541671404,  0.478495449010993,  1.992184744255161,  0.333951010803546 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000,  6.655773965243499, 0.169651292192538,  5.179800873632784, 2.149507285667150,  6.283684233638220, -0.645479075235204,  1.027081931408493 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 5.254188422424477, -6.715339873935628, 2.053923221210496,  8.512216710419459,  2.307405929749960,  2.107967404794224 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000, -9.464114793276034, 4.946127816512377,  6.628553101741168,  0.155913636719474, -2.085750939237665 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000, 3.931767755773501,  3.984307335236524,  1.823617652005219, -2.248396632918166 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000, -5.326013241595878,  3.475940545000401,  4.388758952026945 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000,  4.020824604788080,  9.242293465315168 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000, 0.000000000000000,  0.000000000000000,  0.000000000000000,  3.279189768619025 }
		};

		internal const double Determinant = 17011962.9297146;

		internal static double[,] Inverse => new double[,] {
			{ -2.27411235611569928, -0.15826165906834855, -0.03971366478919014,  0.54754530193387962,  0.84564546633614235,  1.76721370456951843,  1.07391361538651520, -0.62155870054409057, -0.48250146850855319,  0.01019672027462176 },
			{  0.22484785089916492,  0.00497907689343147,  0.13355139007048836, -0.21626167761339685, -0.27191124159200897, -0.36042272648326040, -0.27315652370363785,  0.13047889239071397,  0.11312595580665039,  0.24862184749402985 },
			{  0.85524708549332884, -0.02663142509079858, -0.21829010594211209, -0.07597446983339490, -0.01766347951461328, -0.53299319519938937, -0.06431049500906261,  0.27920956699260274,  0.26180037063438799, -0.41872053823446070 },
			{  0.34237656340852235,  0.03459601132902049,  0.11949903520731535, -0.19007445235964410, -0.11792258334227484, -0.27461758503063410, -0.15251968219587270,  0.18773290343148835,  0.06545173333927046, -0.02961375774379703 },
			{ -0.39068346608479154,  0.07845459651457942,  0.09774788148584986, -0.01521396023045585,  0.06844010119667270,  0.43057281385323593,  0.07445500310690192, -0.19743881021017737, -0.11463880104990820,  0.10158403387034382 },
			{ -0.11960415368814295, -0.05119078661773287, -0.03566587991127522,  0.06853351500300096,  0.01436951605887161,  0.14708417097528839, -0.00814944922996601, -0.08252364659457270, -0.04128303503403435,  0.07686109851615172 },
			{ -0.92793063264049869,  0.03570990897064419,  0.11967641827069420,  0.18738507248004255,  0.20472013048747825,  0.70845142046674026,  0.38479902039033159, -0.33005309126766913, -0.32640176089583317,  0.20590823734853814 },
			{  0.23449114961146644,  0.01001523641491844, -0.13703778143468803,  0.02633392674276008, -0.03144987262923478, -0.20618716346918950, -0.05966091488615446,  0.18859627051238026,  0.08264185150921957, -0.07456849694250196 },
			{  0.82730381666590347,  0.09025541547457155,  0.05933160954592846, -0.21358055509691320, -0.30999188330290900, -0.70096781085450788, -0.53533297754915421,  0.16046882480870420,  0.15376464768899153,  0.16213121995953983 },
			{ -0.41339744413805679, -0.05827031189181564,  0.01456033811781599,  0.20111566009168913,  0.12490019370398427,  0.30495337890162211,  0.24042238135589683, -0.15636978776831514, -0.05449355077458019, -0.08532973391890820 }
		};

		internal static double[] EigenvaluesRealPart => new double[]
		{
			 39.1704534933583200, 9.6733808137362020, 6.8315684464554830, 4.9691564280223170, -1.4325846620495990, -1.4325846620495990, -5.1947609315368840, -5.1947609315368840, -0.7448864835033934, -2.0616815108959500
		};

		internal static double[] EigenvaluesImaginaryPart => new double[]
		{
			 +0.0, +0.0, +0.0, +0.0, +5.408105558371837, -5.408105558371837, +0.7272146732164515, -0.7272146732164515, +0.0, +0.0
		};

		internal static double[,] EigenvectorsLeft => new double[,]
		{
			{ +0.1346290250378348, +0.16150770481963270, -0.29513412929327440, +0.223337078514103100, -0.15141240255125860, -0.04812429314790514, -0.22114133726869400, -0.054132445578569330, -0.65982162942136910, +0.19208462373673850 },
			{ +0.2627123928188636, +0.27432753000616160, +0.09564488225550430, +0.121663824652140400, +0.33807289333489820, +0.11629228650219570, +0.28287040653421700, -0.087989745384869950, -0.09604541959320620, +0.28832314771360460 },
			{ +0.3947775700454352, +0.23620713741970470, +0.12303064268725340, -0.146471694306254400, +0.08677666381632360, +0.15029566491644680, +0.10405572154356620, -0.055899284485197500, -0.09900207814458969, +0.32566280299353840 },
			{ +0.3305335348316265, -0.34826111766190330, +0.18099147169006170, -0.095395415172859420, -0.37886828816917450, -0.05208376072059656, -0.16660953471790050, -0.003629955047399148, +0.21295129476755900, -0.31510993657780250 },
			{ +0.2380072299445662, +0.07419805173003928, -0.24017718492333230, -0.002344139211444176, +0.05863306685426606, +0.41240551033551820, +0.22652196020914910, +0.096222424454328600, +0.32434240752694940, -0.30190157942684610 },
			{ +0.3614932131601052, -0.74347078730556450, +0.09883000959275000, -0.699780728520335500, +0.44631040974254670, +0000000000000000000, +0.08646893197742389, -0.050324908993699400, +0.45824325627381050, -0.07186253267001215 },
			{ +0.3106920991150162, +0.03568890127056327, +0.72807362780815100, -0.250457018375503700, +0.03578922994996114, +0.20309121060276320, -0.25446272484177220, +0.053714078610334920, +0.38811641949101370, -0.46030255026249190 },
			{ +0.3396124864583393, -0.20659840973717140, +0.26351815934262760, +0.511673632511680600, +0.01260139504501767, +0.15726951377970900, -0.06433752277875746, +0.056888136470357940, -0.12207615260693140, -0.06239216133054714 },
			{ +0.3514862783643950, +0.34158278933696950, -0.43351623725304560, +0.300818384259372800, -0.20138845170944890, -0.13412270842806090, -0.49041629750538570, +0.021979377744565320, -0.07294652690857678, -0.24622686832526480 },
			{ +0.3535843136529307, +0.05186988252484796, +0.03052283786235221, +0.005944164877591546, +0.18492249199097960, -0.37107576149820300, +0.65734341618436500, +0.000000000000000000, -0.11923930627148580, +0.54946796895876340 }
		};

		internal static double[,] EigenvectorsRight => new double[,]
		{
			{ +0.32678615875224180, -0.03263344036493219, -0.00430817666780283, -0.4908742294253686, -0.08260792908820513, -0.07502343378051754, -0.01316475674560672, -0.07668852381393969, -0.76811323270096440, -0.408953202901943400 },
			{ +0.07060303833022699, +0.31729742995126800, +0.11750028290684330, +0.4535027518862313, -0.17797022347315430, -0.11703177803606610, -0.73666315551736770, -0000000000000000000, -0.01057525376492594, -0.388900537119509900 },
			{ +0.37281258010781620, +0.03724967864731576, -0.04371580033340296, -0.1839346819583746, +0.57497939090153390, -0.00000000000000000, +0.24744168936272860, +0.10560474285804030, +0.40502823075094310, +0.680122335221958100 },
			{ +0.36255713814782570, -0.21540142927217480, +0.07460353188292720, +0.1453774830761572, +0.27689079553085270, +0.38090120050030610, -0.46135435838300370, -0.01853225217237541, +0.08151664777278250, -0.166080334888700200 },
			{ +0.27693971457385110, +0.09770877908007441, -0.45159899643770880, -0.1852323251633069, +0.19329106941088690, -0.11359894120143790, +0.11427229959815250, -0.10653746294088490, -0.16352302039022530, -0.199001576583835000 },
			{ +0.26506981869922540, -0.40505893231839430, -0.26622497129144720, -0.1594815444148379, -0.17907039544661730, -0.17731933263244830, +0.01711173609491302, +0.03113451377342332, -0.03483129494982891, -0.005863689803019026 },
			{ +0.20499329439275840, +0.46348638275144800, +0.67786197028301350, -0.3589180325329651, -0.25148685300439310, -0.04999450752230686, +0.14323530286942240, -0.04647761141106747, -0.32673423142752910, -0.287138060016665000 },
			{ +0.20580895639111900, -0.59273491479084820, +0.19674095820842670, +0.4975287556095556, +0.07680252076624948, -0.16025567809069090, +0.22401101468090580, +0.03551860824388885, +0.11005650565866140, +0.237846671512475600 },
			{ +0.45637277985102450, +0.29528753259861750, -0.43741099223392660, +0.1979283807682148, -0.24826410565223930, +0.03790362039507213, +0.05655043428590493, +0.07696565019909002, +0.25921328987514040, +0.082105074314701210 },
			{ +0.42210876958275950, +0.15330788612427290, +0.11978624511991890, -0.1520957828520478, -0.29015111137511290, +0.17737675992725380, +0.21571214416598800, -0.10128641322886940, -0.15869837683631010, -0.077252982667392540 }
		};

		internal static string FilePath => Directory.GetParent(Directory.GetCurrentDirectory()).Parent.Parent.FullName
			+ @"\MGroup.LinearAlgebra.Tests\Resources\SquareInvertible10by10.txt";
	}
}
