using System.IO;
using MGroup.LinearAlgebra.Tests.Utilities;

namespace MGroup.LinearAlgebra.Tests.TestData
{
	/// <summary>
	/// A symmetric 10-by-10 matrix that is positive definite.
	/// Authors: Serafeim Bakalakos
	/// </summary>
	internal static class SymmPosDef10by10
	{
		internal const int Order = 10;

		internal static double[,] Matrix => new double[,]
		{
			{ 8.9156,    0.4590,    0.0588,    0.5776,    0.7118,    0.7423,    0.4389,    0.4353,    0.4929,    0.7223 },
			{ 0.4590,    7.5366,    0.4276,    0.3282,    0.5277,    0.4274,    0.2498,    0.7622,    0.4987,    0.8953 },
			{ 0.0588,    0.4276,    6.4145,    0.4144,    0.5954,    0.6196,    0.3257,    0.5084,    0.6342,    0.5270 },
			{ 0.5776,    0.3282,    0.4144,    7.7576,    0.6609,    0.9212,    0.8040,    0.2146,    0.5077,    0.3928 },
			{ 0.7118,    0.5277,    0.5954,    0.6609,    9.0882,    0.5096,    0.3434,    0.6139,    0.7590,    0.5276 },
			{ 0.7423,    0.4274,    0.6196,    0.9212,    0.5096,   10.5523,    0.4885,    0.7861,    0.5294,    0.7933 },
			{ 0.4389,    0.2498,    0.3257,    0.8040,    0.3434,    0.4885,    7.5277,    0.6574,    0.4020,    0.2763 },
			{ 0.4353,    0.7622,    0.5084,    0.2146,    0.6139,    0.7861,    0.6574,    7.5142,    0.3528,    0.6254 },
			{ 0.4929,    0.4987,    0.6342,    0.5077,    0.7590,    0.5294,    0.4020,    0.3528,    7.8487,    0.3035 },
			{ 0.7223,    0.8953,    0.5270,    0.3928,    0.5276,    0.7933,    0.2763,    0.6254,    0.3035,    9.6122 }
		};

		internal static double[] Lhs => new double[]
		{
			2.6621, 3.5825, 0.8965, 1.6827, 0.9386, 1.6096, 2.0193, 2.7428, 0.2437, 2.7637
		};

		internal static double[] Rhs => MatrixOperations.MatrixTimesVector(Matrix, Lhs);

		/// <summary>
		/// Cholesky factor U, such that A = transpose(U) * U.
		/// </summary>
		internal static double[,] FactorU => new double[,]
		{
			{ 2.985900199269895, 0.153722485470959, 0.019692553694319, 0.193442500235351, 0.238387070061500, 0.248601745021989, 0.146990847218309, 0.145785180665596, 0.165075845509010, 0.241903597506914 },
			{ 0.000000000000000, 2.740979641927431, 0.154898199609496, 0.108889366963057, 0.179152934802792, 0.141987308446090, 0.082891604938865, 0.269899684173881, 0.172684292687522, 0.313068351410101 },
			{ 0.000000000000000, 0.000000000000000, 2.527868420445719, 0.155753303096660, 0.222699519569065, 0.234470597262118, 0.122619362611506, 0.183443939802229, 0.239015901351388, 0.187407925427375 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000, 2.772014432401022, 0.202232631677458, 0.296221177330862, 0.269638328403751, 0.046333721550306, 0.151419239152157, 0.101993100023086 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 2.984758401855593, 0.104791408769016, 0.070917654936901, 0.161008110202667, 0.202649741106407, 0.117759684669540 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 3.211951445831759, 0.100914814317546, 0.198610011505956, 0.106387392924291, 0.187492324676960 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 2.719608284827539, 0.201187193613787, 0.098608821172701, 0.050389081670723 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 2.697861470439624, 0.058442004174847, 0.148338479378222 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 2.765149064841803, 0.033206016423912 },
			{ 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 3.055401743667175 }
		};

		internal const double Determinant = 1161566697.17954;

		internal static double[,] Inverse => new double[,]
		{
			{  1.15036865934732e-001,   -4.39532821775264e-003,   2.42037551285770e-003, -5.97442668250739e-003, -6.90720784369428e-003, -5.95113316951374e-003, -4.47671372388698e-003, -3.83803697247067e-003, -5.02329472415375e-003, -6.71622551868538e-003 },
			{ -4.39532821775264e-003,    1.36732896698586e-001,  -5.75169213114003e-003, -3.03503313527466e-003, -4.92435739258999e-003, -2.38087837250887e-003, -1.63915778627162e-003, -1.11803335814405e-002, -6.12024602474453e-003, -1.05313557472777e-002 },
			{  2.42037551285770e-003,   -5.75169213114003e-003,   1.60325077112127e-001, -5.41279316018277e-003, -7.68848261959135e-003, -6.76133191373731e-003, -4.07388870269966e-003, -7.54515406778568e-003, -1.04002539890800e-002, -6.29854537225606e-003 },
			{ -5.97442668250739e-003,   -3.03503313527466e-003,  -5.41279316018277e-003,  1.33253132115769e-001, -7.09955954426047e-003, -9.40120824258935e-003, -1.22461377827815e-002,  3.39760670285888e-004, -5.57539070903115e-003, -2.74544183434557e-003 },
			{ -6.90720784369428e-003,   -4.92435739258999e-003,  -7.68848261959135e-003, -7.09955954426047e-003,  1.13451942211347e-001, -2.44301774738121e-003, -2.20996709440458e-003, -6.50308607590307e-003, -8.43523792979407e-003, -3.58326599023808e-003 },
			{ -5.95113316951374e-003,   -2.38087837250887e-003,  -6.76133191373731e-003, -9.40120824258935e-003, -2.44301774738121e-003,  9.79882099638576e-002, -3.42245325864104e-003, -7.77186111730655e-003, -3.94470775148731e-003, -5.80050621175504e-003 },
			{ -4.47671372388698e-003,   -1.63915778627162e-003,  -4.07388870269966e-003, -1.22461377827815e-002, -2.20996709440458e-003, -3.42245325864104e-003,  1.36133387065973e-001, -9.98325470041244e-003, -4.51446541537761e-003, -1.50440957718562e-003 },
			{ -3.83803697247067e-003,   -1.11803335814405e-002,  -7.54515406778568e-003,  3.39760670285888e-004, -6.50308607590307e-003, -7.77186111730655e-003, -9.98325470041244e-003,  1.37773923159142e-001, -2.76274802050418e-003, -5.86189359820442e-003 },
			{ -5.02329472415375e-003,   -6.12024602474453e-003,  -1.04002539890800e-002, -5.57539070903115e-003, -8.43523792979407e-003, -3.94470775148731e-003, -4.51446541537761e-003, -2.76274802050418e-003,  1.30801943186731e-001, -1.28635721186656e-003 },
			{ -6.71622551868538e-003,   -1.05313557472777e-002,  -6.29854537225606e-003, -2.74544183434557e-003, -3.58326599023808e-003, -5.80050621175504e-003, -1.50440957718562e-003, -5.86189359820442e-003, -1.28635721186656e-003,  1.07118222072671e-001 }
		};

		internal static double[] Eigenvalues => new double[]
		{
			5.995571109990341, 6.442450749292099, 6.930645630567513, 7.417937412575534, 7.543853394730687, 7.910494861167848, 8.367863725785906, 9.063304893989098, 9.521134827799919, 13.57434339410105
		};

		internal static double[,] Eigenvectors => new double[,]
		{
			{  1.169210576298615E-01,  2.865175216541738E-02, -2.454368930918755E-02, -1.019248749170476E-02,  -1.329781616403030E-01,  1.328864131809676E-01, -8.922483361868269E-01,  1.123830703221553E-01, -1.832415261826510E-01, 3.273312829109259E-01 },
			{ -3.008515109809417E-02, -3.933585633906281E-01,  6.970339602724799E-01,  2.102567789503415E-02,  -4.531183157752696E-01, -1.792028851875091E-01,  1.208428531818940E-01, -9.882458223083156E-02, -1.965757277874699E-01, 2.400506431206261E-01 },
			{  9.353782009087016E-01,  1.467449532234529E-01, -3.650618795962629E-02, -1.019466396683833E-01,  -4.946571586652049E-02, -1.026775593784473E-01,  2.028314327846605E-01,  4.131830485239815E-02, -3.894090158511918E-02, 1.856178772788630E-01 },
			{ -1.041267656949022E-01,  3.987008293264153E-01,  4.775222617751355E-01, -1.534955561186656E-02,   6.049241035560630E-01, -3.467536941603567E-01, -3.859874990643680E-02,  2.020453439558596E-01,  3.440497247247205E-02, 2.688214349631582E-01 },
			{ -6.779054995089370E-02, -1.160172717955797E-01, -4.650969395092688E-02,  2.016721280104737E-01,   1.424248620805821E-01,  5.520324740403716E-01,  3.141728660498966E-01,  5.069921526461117E-01, -3.746119723870818E-01, 3.435188189000622E-01 },
			{ -4.450612311550668E-02, -1.146665788505330E-01, -1.769150929171565E-02, -1.672661694854393E-02,  -4.420682902468422E-02,  2.273464027128775E-01,  5.633027337306837E-02, -7.410461240670968E-02,  7.952955922616326E-01, 5.380313267612404E-01 },
			{  1.031601006653552E-02, -5.407201468644302E-01, -3.878448335813134E-01,  3.354185796821686E-01,   1.974876758216810E-01, -5.833725834152963E-01, -2.681646366623350E-02,  1.487707248344021E-01, -2.383550994928625E-02, 2.045510405046893E-01 },
			{ -1.887860743860637E-01,  5.864741673311830E-01, -2.015494574322044E-01,  4.395300612594959E-01,  -4.879218769810465E-01, -2.380990109716488E-01,  1.408212566622157E-01, -4.481279411235517E-04, -6.624140057405188E-02, 2.600410799664703E-01 },
			{ -2.289152263084966E-01,  3.099561322947691E-02, -2.559639474049537E-01, -7.975938924864316E-01,  -1.907363553985063E-01, -2.378120629433733E-01,  1.249522113656654E-01,  2.533685225232361E-01, -1.210051463152342E-01, 2.399535123815398E-01 },
			{ -7.017443592761427E-02,  7.231820755948680E-03, -1.585609380058226E-01, -7.762451456450224E-02,   2.700592339589643E-01,  9.721725623202446E-02,  9.283837649341269E-02, -7.656455773431016E-01, -3.642154874990054E-01, 3.924129109028231E-01 }
		};

		internal static string FilePath => Directory.GetParent(Directory.GetCurrentDirectory()).Parent.Parent.FullName
			+ @"\MGroup.LinearAlgebra.Tests\Resources\SymmPosDef10by10.txt";
	}
}
